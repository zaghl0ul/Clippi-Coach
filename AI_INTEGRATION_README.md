# Slippi Coach AI Integration Guide

This document explains how to use the AI-powered commentary and coaching features in Slippi Coach. The integration supports both local language models (via LM Studio) and OpenAI's API.

## Table of Contents

1. [Overview](#overview)
2. [Setup Instructions](#setup-instructions)
   - [Option 1: Local LLM Setup](#option-1-local-llm-setup)
   - [Option 2: OpenAI API Setup](#option-2-openai-api-setup)
3. [Features](#features)
4. [Usage Examples](#usage-examples)
5. [Customization](#customization)
6. [Troubleshooting](#troubleshooting)

## Overview

The AI integration provides two main capabilities:

1. **Live Commentary**: Real-time commentary during matches for events like combos, stock losses, and technical executions.
2. **Post-Match Coaching**: Detailed analysis and advice after a match, with character-specific technical insights.

Both features can operate in multiple modes:
- **Template-based**: Uses pre-defined templates (no LLM required)
- **LLM-powered**: Uses language models for more dynamic, context-aware responses
- **Hybrid**: Intelligently combines templates and LLM based on the complexity of events

## Setup Instructions

### Option 1: Local LLM Setup

This option is **free** and runs entirely on your computer, with no API keys required.

1. Download and install [LM Studio](https://lmstudio.ai/)
2. In LM Studio:
   - Download a model (recommended models: Mistral 7B Instruct, Llama-3 8B, Phi-3-mini)
   - Go to Settings > Server tab
   - Check "Enable server" and note the local address (usually http://localhost:1234)
   - Click "Start server"
3. In Slippi Coach, run the setup script:
   ```
   node setup-local-llm.js
   ```
4. Choose "Use a local LLM through LM Studio" and enter the server address
5. Restart Slippi Coach to apply changes

### Option 2: OpenAI API Setup

This option requires an OpenAI API key and incurs usage costs.

1. Create an account at [OpenAI](https://platform.openai.com/)
2. Generate an API key in your account settings
3. In Slippi Coach, run the setup script:
   ```
   node setup-local-llm.js
   ```
4. Choose "Use OpenAI API" and enter your API key
5. Restart Slippi Coach to apply changes

## Features

### Commentary Modes

- **Template Only**: Fast, pre-defined responses with no LLM dependency
- **LLM Only**: All commentary generated by LLM (OpenAI or local)
- **Hybrid**: Uses templates for simple events, LLM for complex events
- **Adaptive**: Automatically determines when to use LLM based on event complexity

### Coaching Profiles

- **Technical Execution**: Focuses on frame-perfect inputs and technical mechanics
- **Neutral Game**: Focuses on spacing, positioning, and stage control
- **Punish Optimization**: Focuses on combo extensions and maximizing damage
- **Matchup-Specific**: Focuses on character matchup dynamics
- **Defensive Options**: Focuses on recovery, DI, and survival
- **Comprehensive**: Balanced coverage of all aspects

## Usage Examples

### Testing the Integration

Run the test script to verify your setup and explore the features:

```
node test-ai-integration.js
```

This interactive test allows you to try different commentary modes and coaching profiles.

### Integration in Your Code

```javascript
import SlippiAIIntegration, { COMMENTARY_MODES, COACHING_PROFILES } from './src/integratedCommentary.js';

// Initialize once
const slippiAI = new SlippiAIIntegration();

// For live commentary during gameplay
slippiAI.generateCommentary([event], { 
  gameState: currentGameState 
}).then(commentary => {
  console.log("🎙️ " + commentary);
});

// For post-game coaching
slippiAI.generateCoaching(matchData, {
  coachingProfile: COACHING_PROFILES.TECHNICAL_EXECUTION,
  targetPlayerIndex: 0 // Focus on Player 1
}).then(coaching => {
  console.log("🧠 Coaching Analysis:\n" + coaching);
});
```

## Customization

### Adding Custom Templates

Modify `src/templateCommentary.js` to add new templates for specific event types.

### Adjusting LLM Parameters

For more technical or creative responses, adjust the parameters in:
- `src/hybridCommentary.js` for commentary settings
- `src/enhancedTechnicalCoaching.js` for coaching settings

### Frame Data Integration

For advanced technical analysis with frame data:
1. Capture frame data during gameplay
2. Pass the frame data to the coaching function:

```javascript
slippiAI.generateCoaching(matchData, {
  frameData: capturedFrameData,
  coachingProfile: COACHING_PROFILES.TECHNICAL_EXECUTION
});
```

## Troubleshooting

### LM Studio Connection Issues

- Ensure LM Studio server is running
- Check that the port (default: 1234) is not blocked by firewall
- Verify the endpoint URL in your .env file matches LM Studio's server address

### OpenAI API Issues

- Verify your API key is correct and has not expired
- Check for rate limiting or quota issues in your OpenAI dashboard
- Ensure you have billing set up for API usage

### Performance Optimization

- For real-time commentary during matches, use `COMMENTARY_MODES.TEMPLATE_ONLY`
- Save LLM-powered analysis for significant events or post-match coaching
- Adjust `maxTokens` parameters to control response length and generation time

## Support

For issues with this integration, please file an issue in the project repository or contact the developer.

---

*This AI integration was developed to provide high-quality technical commentary and coaching for Super Smash Bros. Melee players. The implementation supports both free local models and cloud-based services to accommodate different user preferences.*